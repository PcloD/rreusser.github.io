/*
 * jQuery throttle / debounce - v1.1 - 3/7/2010
 * http://benalman.com/projects/jquery-throttle-debounce-plugin/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
!function(t,i){var e,s=t.jQuery||t.Cowboy||(t.Cowboy={});s.throttle=e=function(t,e,n,r){function a(){function s(){u=+new Date,n.apply(h,f)}function a(){o=i}var h=this,c=+new Date-u,f=arguments;r&&!o&&s(),o&&clearTimeout(o),r===i&&c>t?s():e!==!0&&(o=setTimeout(r?a:s,r===i?t-c:t))}var o,u=0;return"boolean"!=typeof e&&(r=n,n=e,e=i),s.guid&&(a.guid=n.guid=n.guid||s.guid++),a},s.debounce=function(t,s,n){return n===i?e(t,s,!1):e(t,n,s!==!1)}}(this),function(t){this.FrameInstance=t(jQuery)}(function(t){function i(i){t.extend(!0,{},i);return STATE={},EVENTS={},FrameSubsInstance=function(t){return this.start(t)},FSI=FrameSubsInstance.prototype={constructor:FrameSubsInstance,start:function(){this.listenForMessages()},listenForMessages:function(){window.addEventListener("message",function(t){t.origin==window.location.origin&&this.trigger(t.data)}.bind(this))},on:function(t,i){return void 0===EVENTS[t]&&(EVENTS[t]=[]),EVENTS[t].push(i),this},trigger:function(t){var i=EVENTS[t];if(void 0!==i)for(var e=i.length,s=0;e>s;s++)i[s].apply(this,arguments);return this},off:function(t,i){}},new FrameSubsInstance}return i}),function(t){this.FrameSubs=t(jQuery)}(function(t){function i(i,e){t.extend(!0,{},e);return STATE={frames:[]},$ELEMENT=t(i),FrameSubsInstance=function(t){return this.start(t)},FSI=FrameSubsInstance.prototype={constructor:FrameSubsInstance,start:function(i){return this.$el=t(i),this.src=this.$el.attr("data-frame-subs-url"),this.width=this.$el.attr("data-frame-subs-width")||"auto",this.height=this.$el.attr("data-frame-subs-height")||"auto",this.attach(),this.visible=void 0,this},attach:function(){this.frame=document.createElement("iframe"),this.$frame=t(this.frame),this.$wrapper=t('<div class="framesub-wrapper"></div>'),this.$frame.on("load",function(){this.loaded=!0,this.updateVisibility()}.bind(this)),this.$frame.attr("src",this.src),this.$frame.css({border:"none",height:this.height,width:this.width}),this.visible=!1,this.loaded=!1,this.$wrapper.append(this.$frame),this.$el.replaceWith(this.$wrapper)},detach:function(){this.$frame.replaceWith(this.$el)},requestSource:function(){this.postMessage("requestSource")},updateVisibility:function(){if(this.loaded){var t=this.isVisible();t!=this.visible&&(t?this.trigger("visible"):this.trigger("occluded")),this.visible=t}},isVisible:function(){var i=this.$frame.offset().top,e=this.$frame.outerHeight(),s=i+e,n=t(window).scrollTop(),r=t(window).height();return s>n&&n+r>i},trigger:function(t,i){this.postMessage(t)},postMessage:function(t){this.frame.contentWindow.postMessage(t,"*")},listenForMessages:function(){window.addEventListener("message",function(t){t.origin==window.location.origin})}},FrameSubsSet=function(){return this.start()},FSS=FrameSubsSet.prototype={constructor:FrameSubsSet,start:function(){var i=$ELEMENT.find("[data-frame-subs-url]");return i.each(function(i,e){var s=t(e);if(void 0===s.data("FrameSubs")){var n=new FrameSubsInstance(s);STATE.frames.push(n),s.data("FrameSubs",n)}}),this.onScroll(),this},checkFramePositions:t.throttle(200,function(){t.each(STATE.frames,function(t,i){i.updateVisibility()})}),onScroll:function(){t(window).on("scroll resize",this.checkFramePositions.bind(this)),this.checkFramePositions()},offScroll:function(){t(window).off("scroll resize",this.checkFramePositions.bind(this))},frames:function(){return STATE.frames}},new FrameSubsSet}return i});