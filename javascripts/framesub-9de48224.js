/*
 * jQuery throttle / debounce - v1.1 - 3/7/2010
 * http://benalman.com/projects/jquery-throttle-debounce-plugin/
 *
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
function htmlDecode(t){var e=document.createElement("div");return e.innerHTML=t,0===e.childNodes.length?"":e.childNodes[0].nodeValue}!function(t,e){var i,s=t.jQuery||t.Cowboy||(t.Cowboy={});s.throttle=i=function(t,i,n,r){function a(){function s(){h=+new Date,n.apply(u,d)}function a(){o=e}var u=this,c=+new Date-h,d=arguments;r&&!o&&s(),o&&clearTimeout(o),r===e&&c>t?s():i!==!0&&(o=setTimeout(r?a:s,r===e?t-c:t))}var o,h=0;return"boolean"!=typeof i&&(r=n,n=i,i=e),s.guid&&(a.guid=n.guid=n.guid||s.guid++),a},s.debounce=function(t,s,n){return n===e?i(t,s,!1):i(t,n,s!==!1)}}(this),function(t){this.FrameInstance=t(jQuery)}(function(t){function e(e){var i={};t.extend(!0,{},i,e);return STATE={},EVENTS={},FrameSubsInstance=function(){return this.start()},FSI=FrameSubsInstance.prototype={constructor:FrameSubsInstance,start:function(){this.listenForMessages()},listenForMessages:function(){window.addEventListener("message",function(t){this.trigger(t.data.event,t.data.data)}.bind(this))},on:function(t,e){return void 0===EVENTS[t]&&(EVENTS[t]=[]),EVENTS[t].push(e),this},trigger:function(t,e){var i=EVENTS[t];if(void 0!==i)for(var s=i.length,n=0;s>n;n++)i[n].apply(this,arguments);return this},off:function(t,e){}},new FrameSubsInstance}return e}),function(t){this.FrameSubs=t(jQuery)}(function(t){function e(e,s){var n={locateWith:i["data-attrs"]},r=t.extend(!0,{},n,s);return STATE={frames:[]},$ELEMENT=t(e),FrameSubsInstance=function(t){return this.start(t)},FSI=FrameSubsInstance.prototype={constructor:FrameSubsInstance,start:function(e){return this.options=t.extend(!0,{width:"auto",height:"auto",border:"none"},e),this.$el=t(this.options.element),this.src=this.options.url,this.width=this.options.width,this.height=this.options.height,this.border=this.options.border,this.attach(),this.visible=void 0,this},attach:function(){this.frame=document.createElement("iframe"),this.$frame=t(this.frame),this.$frame.on("load",function(){this.loaded=!0,this.updateVisibility(),this.updateDimensions()}.bind(this)),this.$frame.attr("src",this.src),this.$frame.css({height:this.height,width:this.width,border:"none"===this.border?"none":"1px solid "+this.border}),this.visible=!1,this.loaded=!1,this.$wrapper=t('<div class="framesub-wrapper"></div>'),this.$innerWrapper=t('<div class="framesub-innerWrapper"></div>'),this.$wrapper.append(this.$innerWrapper),this.$innerWrapper.append(this.$frame),this.$fullscreenBtn=t('<button class="framesub-fullscreen"></button>'),this.$controls=t('<div class="framesub-controls"></div>'),this.$controls.append(this.$fullscreenBtn),this.$fullscreenBtn.on("click",function(){this.toggleFullscreen()}.bind(this)),this.$innerWrapper.append(this.$controls),this.$el.replaceWith(this.$wrapper)},toggleFullscreen:function(){this.$wrapper.hasClass("is-fullscreen")?(this.$wrapper.height(""),this.$wrapper.width(""),this.$wrapper.removeClass("is-fullscreen"),this.postMessage({event:"endFullscreen"})):(this.$wrapper.height(this.$innerWrapper.height()),this.$wrapper.width(this.$innerWrapper.width()),this.$wrapper.addClass("is-fullscreen"),this.postMessage({event:"beginFullscreen"}))},detach:function(){this.$frame.replaceWith(this.$el)},requestSource:function(){this.postMessage("requestSource")},updateVisibility:function(){if(this.loaded){var t=this.isVisible();t!=this.visible&&(t?this.trigger("visible"):this.trigger("occluded")),this.visible=t}},updateDimensions:function(){this.loaded&&this.trigger("resize",{width:this.$wrapper.width(),height:this.$wrapper.height()})},isVisible:function(){var e=this.$frame.offset().top,i=this.$frame.outerHeight(),s=e+i,n=t(window).scrollTop(),r=t(window).height();return s>n&&n+r>e},trigger:function(t,e){this.postMessage({event:t,data:e})},postMessage:function(t){this.frame.contentWindow.postMessage(t,"*")},listenForMessages:function(){window.addEventListener("message",function(t){t.origin==window.location.origin})}},FrameSubsSet=function(){return this.start()},FSS=FrameSubsSet.prototype={constructor:FrameSubsSet,start:function(){if("function"==typeof r.locateWith)var e=r.locateWith($ELEMENT);else var e=i[r.locateWith]($ELEMENT);return t.each(e,function(e,i){var s=(t(i.element),new FrameSubsInstance(i));STATE.frames.push(s)}),this.onScroll(),this},checkFramePositions:t.throttle(200,function(){t.each(STATE.frames,function(t,e){e.updateVisibility()})}),updateDimensions:t.throttle(200,function(){t.each(STATE.frames,function(t,e){e.updateDimensions()})}),onScroll:function(){t(window).on("scroll resize",this.checkFramePositions.bind(this)),t(window).on("resize",this.updateDimensions.bind(this)),this.checkFramePositions()},offScroll:function(){t(window).off("scroll resize",this.checkFramePositions.bind(this)),t(window).off("resize",this.updateDimensions.bind(this))},frames:function(){return STATE.frames}},new FrameSubsSet}var i={"data-attrs":function(e){var i=[];return t(e).find("[data-frame-subs], [data-frame-subs-url]").each(function(e,s){var n=t(s);i.push({element:s,url:n.attr("data-frame-subs-url"),width:n.attr("data-frame-subs-width"),height:n.att("data-frame-subs-height"),border:n.att("data-frame-subs-border")})}),i},"code-blocks":function(e){var i=[];return t(e).find("code").each(function(e,s){var n=t(s).html().trim(),r=n.match(/^interactive-frame(\[(.*)\])?\((.*)\)$/);if(r){var a=r[2].split(/\s+/),o=r[3],h={};t.each(a,function(t,e){var i=e.split(/=/);h[i[0]]=i[1]}),o=htmlDecode(o),i.push(t.extend(h,{element:t(s).closest("p")||t(s),url:o}))}}),i}};return e});